# fly.toml app configuration file generated for asistencia-qr-copia-winter-river-2953 on 2025-09-27T22:32:11-05:00
#
# See https://fly.io/docs/reference/configuration/ for information about how to use this file.
#

app = 'asistencia-qr-copia-winter-river-2953'
primary_region = 'gru'

[build]

[http_service]
  internal_port = 8080
  force_https = true
  auto_stop_machines = 'stop'
  auto_start_machines = true
  min_machines_running = 0
  processes = ['app']

[[vm]]
  memory = '1gb'
  cpu_kind = 'shared'
  cpus = 1
# fly.toml

# ... (El resto de tu configuraci칩n es la misma: [http_service], [[vm]], etc.)

[[statics]]
  guest_path = "/app/src/jobs" # Asegura que la carpeta jobs est칠 accesible

# 游녢 A칌ADIR ESTA SECCI칍N PARA EL CRON JOB
[[vm]]
  processes = ["worker"] # Este worker se encargar치 de ejecutar el cron
  cpu_kind = "shared"
  cpus = 1
  memory = "256mb" # Suficiente memoria para el worker

[processes]
  # Proceso principal web (ya lo tienes, solo para referencia)
  app = "gunicorn app:app -c gunicorn.conf.py" 

  # 游녢 PROCESO WORKER CRON
  # Usamos el comando "cron" de Linux para programar la ejecuci칩n
  worker = "/usr/bin/python3 /app/src/jobs/run_weekly_report.py"

[[machines]]
  name = "cron-job"
  schedule = "0 8 * * 1" # Lunes a las 8:00 AM (0 minutos, hora 8, cualquier d칤a/mes, d칤a 1 de la semana)
  processes = ["worker"]
  region = "gru" # Ejecutar solo en una regi칩n